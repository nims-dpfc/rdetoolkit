
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../invoicefile/" rel="prev"/>
<link href="../validation/" rel="next"/>
<link href="../../img/2585322.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.38" name="generator"/>
<title>modeproc - RDEToolKit Documentation</title>
<link href="../../assets/stylesheets/main.8c3ca2c6.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Noto+Sans+JP:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Noto Sans JP";--md-code-font:"Roboto Mono"}</style>
<link href="../../assets/_mkdocstrings.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#modeproc">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="RDEToolKit Documentation" class="md-header__button md-logo" data-md-component="logo" href="../.." title="RDEToolKit Documentation">
<img alt="logo" src="../../img/2585322.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            RDEToolKit Documentation
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              modeproc
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/nims-dpfc/rdetoolkit" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    nims-dpfc/rdetoolkit
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
          
  
  Getting started

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../install/">
          
  
  Installation

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../usage/quickstart/">
          
  
  User Guide

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../impl/compressed_controller/">
          
  
  API Documentation

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../contribute/home/">
          
  
  Development

        </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="RDEToolKit Documentation" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="RDEToolKit Documentation">
<img alt="logo" src="../../img/2585322.png"/>
</a>
    RDEToolKit Documentation
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/nims-dpfc/rdetoolkit" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    nims-dpfc/rdetoolkit
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
<span class="md-ellipsis">
    Getting started
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    RDEToolKit
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Installation
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Installation
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../install/">
<span class="md-ellipsis">
    インストール方法
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    User Guide
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
<span class="md-ellipsis">
    Quick Start
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_1">
<span class="md-nav__icon md-icon"></span>
            Quick Start
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/quickstart/">
<span class="md-ellipsis">
    クイックスタート
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
<span class="md-ellipsis">
    構造化処理
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_2">
<span class="md-nav__icon md-icon"></span>
            構造化処理
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/structured_process/structured/">
<span class="md-ellipsis">
    構造化処理を構築する
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/structured_process/directory/">
<span class="md-ellipsis">
    サポートするディレクトリ
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/structured_process/rdepath/">
<span class="md-ellipsis">
    構造化ディレクトリパスの取得
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/structured_process/errorhandling/">
<span class="md-ellipsis">
    構造化処理のエラーハンドリング
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/structured_process/feature_description/">
<span class="md-ellipsis">
    データタイル説明欄への自動記述について
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
<span class="md-ellipsis">
    設定ファイル
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_3">
<span class="md-nav__icon md-icon"></span>
            設定ファイル
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/config/config/">
<span class="md-ellipsis">
    RDEToolKit設定ファイル
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/config/mode/">
<span class="md-ellipsis">
    RDEToolKitのデータ登録モード
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/config/file_folder_mode/">
<span class="md-ellipsis">
    圧縮ファイルの形式について
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/config/magic_variable/">
<span class="md-ellipsis">
    Magic Variableによるデータ登録について
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
<span class="md-ellipsis">
    テンプレートファイル
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_4">
<span class="md-nav__icon md-icon"></span>
            テンプレートファイル
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/metadata_definition_file/">
<span class="md-ellipsis">
    テンプレートファイル
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
<span class="md-ellipsis">
    バリデーション
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_5">
<span class="md-nav__icon md-icon"></span>
            バリデーション
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/validation/">
<span class="md-ellipsis">
    バリデーション機能
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
<span class="md-ellipsis">
    Docker
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_6">
<span class="md-nav__icon md-icon"></span>
            Docker
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../usage/docker/">
<span class="md-ellipsis">
    Using RDEToolKit with Docker
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
<span class="md-ellipsis">
    API Documentation
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            API Documentation
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
<span class="md-ellipsis">
    impl
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_1">
<span class="md-nav__icon md-icon"></span>
            impl
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../impl/compressed_controller/">
<span class="md-ellipsis">
    compressed_controller
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../impl/input_controller/">
<span class="md-ellipsis">
    input_controller
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
<span class="md-ellipsis">
    interface
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_2">
<span class="md-nav__icon md-icon"></span>
            interface
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../interface/filechecker/">
<span class="md-ellipsis">
    filechecker
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
<span class="md-ellipsis">
    models
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_3">
<span class="md-nav__icon md-icon"></span>
            models
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../models/invoice_schema/">
<span class="md-ellipsis">
    invoice_schema
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../models/metadata/">
<span class="md-ellipsis">
    metadata
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../models/rde2types/">
<span class="md-ellipsis">
    rde2types
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../config/">
<span class="md-ellipsis">
    config
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../workflows/">
<span class="md-ellipsis">
    workflows
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../rde2util/">
<span class="md-ellipsis">
    rde2util
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../invoicefile/">
<span class="md-ellipsis">
    invoicefile
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    modeproc
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    modeproc
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#invoice_mode_process">
<span class="md-ellipsis">
      invoice_mode_process
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#excel_invoice_mode_process">
<span class="md-ellipsis">
      excel_invoice_mode_process
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#rdeformat_mode_process">
<span class="md-ellipsis">
      rdeformat_mode_process
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#copy_input_to_rawfile_for_rdeformat">
<span class="md-ellipsis">
      copy_input_to_rawfile_for_rdeformat
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#multifile_mode_process">
<span class="md-ellipsis">
      multifile_mode_process
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#copy_input_to_rawfile">
<span class="md-ellipsis">
      copy_input_to_rawfile
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#selected_input_checker">
<span class="md-ellipsis">
      selected_input_checker
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../validation/">
<span class="md-ellipsis">
    validation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../img2thumb/">
<span class="md-ellipsis">
    img2thumb
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../rdelogger/">
<span class="md-ellipsis">
    rdelogger
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../csv2graph.md">
<span class="md-ellipsis">
    None
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../exceptions/">
<span class="md-ellipsis">
    exceptions
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    Development
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Development
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../contribute/home/">
<span class="md-ellipsis">
    Top
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../contribute/documents_contributing/">
<span class="md-ellipsis">
    Documents
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../contribute/sourcecode_contributing/">
<span class="md-ellipsis">
    Source Code
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="modeproc">modeproc</h1>
<p>In <code>modeproc.py</code>, processes for each input mode of the structuring process are defined.</p>
<h2 id="invoice_mode_process">invoice_mode_process</h2>
<div class="doc doc-object doc-function">
<div class="doc doc-contents first">
<p>Processes invoice-related data, applies dataset transformations using the provided callback function, and updates descriptions.</p>
<p>This function performs several steps:</p>
<ol>
<li>Copies input files to the rawfile directory.</li>
<li>Runs a custom dataset process function if provided.</li>
<li>Copies images to the thumbnail directory.</li>
<li>Replaces the placeholder '${filename}' in the invoice with the actual filename if necessary.</li>
<li>Attempts to update descriptions with features, ignoring any errors during this step.</li>
<li>Validates the metadata-def.json file.</li>
<li>Validates the invoice file against the invoice schema.</li>
</ol>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code>index</code></td>
<td>
<code>str</code>
</td>
<td>
<div class="doc-md-description">
<p>The workflow execution ID (run_id) is a unique identifier used to distinguish a specific execution of a workflow.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>srcpaths</code></td>
<td>
<code><span title="rdetoolkit.models.rde2types.RdeInputDirPaths">RdeInputDirPaths</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Input paths for the source data.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>resource_paths</code></td>
<td>
<code><span title="rdetoolkit.models.rde2types.RdeOutputResourcePath">RdeOutputResourcePath</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Paths to the resources where data will be written or read from.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>datasets_process_function</code></td>
<td>
<code><span title="src.rdetoolkit.modeproc._CallbackType">_CallbackType</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A callback function that processes datasets. Defaults to None.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
<tr class="doc-section-item">
<td><code>config</code></td>
<td>
<code>Config</code>
</td>
<td>
<div class="doc-md-description">
<p>Configuration instance for structured processing execution. Defaults to None.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Name</th> <th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code>WorkflowExecutionStatus</code></td> <td>
<code><span title="rdetoolkit.models.result.WorkflowExecutionStatus">WorkflowExecutionStatus</span></code>
</td>
<td>
<div class="doc-md-description">
<p>An object containing the execution status of the workflow, including:
- run_id (str): The unique identifier for the workflow execution, zero-padded to four digits.
- title (str): A descriptive title for the workflow execution.
- status (str): The status of the workflow execution, either "success" or "failed".
- mode (str): The mode in which the workflow was executed, e.g., "rdeformat".
- error_code (int | None): The error code if an error occurred, otherwise None.
- error_message (str | None): The error message if an error occurred, otherwise None.
- target (str): The target directory or file path related to the workflow execution.</p>
</div>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>src/rdetoolkit/modeproc.py</code></summary>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">301</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">302</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">303</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">304</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">305</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">306</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">307</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">308</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">309</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">310</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">311</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">312</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">313</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">314</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">315</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">316</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">317</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">318</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">319</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">320</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">321</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">322</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">323</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">324</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">325</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">326</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">327</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">328</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">329</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">330</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">331</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">332</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">333</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">334</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">335</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">336</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">337</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">338</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">339</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">340</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">341</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">342</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">343</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">344</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">345</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">346</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">347</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">348</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">349</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">350</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">351</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">352</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">353</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">354</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">355</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">356</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">357</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">358</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">359</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">360</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">361</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">362</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">363</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">364</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">365</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">366</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">367</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">368</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">369</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">370</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">371</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">372</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">373</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">374</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">375</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">376</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">377</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">378</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">379</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">380</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">381</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">382</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">invoice_mode_process</span>(
    index: <span style="color: #007020">str</span>,
    srcpaths: RdeInputDirPaths,
    resource_paths: RdeOutputResourcePath,
    datasets_process_function: _CallbackType <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">None</span>,
) <span style="color: #333333">-&gt;</span> WorkflowExecutionStatus:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Processes invoice-related data, applies dataset transformations using the provided callback function, and updates descriptions.</span>

<span style="color: #DD4422">    This function performs several steps:</span>

<span style="color: #DD4422">    1. Copies input files to the rawfile directory.</span>
<span style="color: #DD4422">    2. Runs a custom dataset process function if provided.</span>
<span style="color: #DD4422">    3. Copies images to the thumbnail directory.</span>
<span style="color: #DD4422">    4. Replaces the placeholder '${filename}' in the invoice with the actual filename if necessary.</span>
<span style="color: #DD4422">    5. Attempts to update descriptions with features, ignoring any errors during this step.</span>
<span style="color: #DD4422">    6. Validates the metadata-def.json file.</span>
<span style="color: #DD4422">    7. Validates the invoice file against the invoice schema.</span>

<span style="color: #DD4422">    Args:</span>
<span style="color: #DD4422">        index: The workflow execution ID (run_id) is a unique identifier used to distinguish a specific execution of a workflow.</span>
<span style="color: #DD4422">        srcpaths (RdeInputDirPaths): Input paths for the source data.</span>
<span style="color: #DD4422">        resource_paths (RdeOutputResourcePath): Paths to the resources where data will be written or read from.</span>
<span style="color: #DD4422">        datasets_process_function (_CallbackType, optional): A callback function that processes datasets. Defaults to None.</span>
<span style="color: #DD4422">        config (Config, optional): Configuration instance for structured processing execution. Defaults to None.</span>

<span style="color: #DD4422">    Raises:</span>
<span style="color: #DD4422">        Any exceptions raised by `datasets_process_function` will propagate upwards. Exceptions during the `update_description_with_features` step are caught and silently ignored.</span>

<span style="color: #DD4422">    Returns:</span>
<span style="color: #DD4422">        WorkflowExecutionStatus: An object containing the execution status of the workflow, including:</span>
<span style="color: #DD4422">            - run_id (str): The unique identifier for the workflow execution, zero-padded to four digits.</span>
<span style="color: #DD4422">            - title (str): A descriptive title for the workflow execution.</span>
<span style="color: #DD4422">            - status (str): The status of the workflow execution, either "success" or "failed".</span>
<span style="color: #DD4422">            - mode (str): The mode in which the workflow was executed, e.g., "rdeformat".</span>
<span style="color: #DD4422">            - error_code (int | None): The error code if an error occurred, otherwise None.</span>
<span style="color: #DD4422">            - error_message (str | None): The error message if an error occurred, otherwise None.</span>
<span style="color: #DD4422">            - target (str): The target directory or file path related to the workflow execution.</span>
<span style="color: #DD4422">    """</span>
    <span style="color: #008800; font-weight: bold">if</span> srcpaths<span style="color: #333333">.</span>config<span style="color: #333333">.</span>system<span style="color: #333333">.</span>save_raw:
        copy_input_to_rawfile(resource_paths<span style="color: #333333">.</span>raw, resource_paths<span style="color: #333333">.</span>rawfiles)

    <span style="color: #008800; font-weight: bold">if</span> srcpaths<span style="color: #333333">.</span>config<span style="color: #333333">.</span>system<span style="color: #333333">.</span>save_nonshared_raw:
        copy_input_to_rawfile(resource_paths<span style="color: #333333">.</span>nonshared_raw, resource_paths<span style="color: #333333">.</span>rawfiles)

    <span style="color: #888888"># run custom dataset process</span>
    <span style="color: #008800; font-weight: bold">if</span> datasets_process_function <span style="color: #000000; font-weight: bold">is</span> <span style="color: #000000; font-weight: bold">not</span> <span style="color: #008800; font-weight: bold">None</span>:
        datasets_process_function(srcpaths, resource_paths)

    <span style="color: #008800; font-weight: bold">if</span> srcpaths<span style="color: #333333">.</span>config<span style="color: #333333">.</span>system<span style="color: #333333">.</span>save_thumbnail_image:
        img2thumb<span style="color: #333333">.</span>copy_images_to_thumbnail(resource_paths<span style="color: #333333">.</span>thumbnail, resource_paths<span style="color: #333333">.</span>main_image)

    <span style="color: #888888"># rewriting support for ${filename} by default</span>
    <span style="color: #008800; font-weight: bold">if</span> srcpaths<span style="color: #333333">.</span>config<span style="color: #333333">.</span>system<span style="color: #333333">.</span>magic_variable:
        apply_magic_variable(resource_paths<span style="color: #333333">.</span>invoice<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"invoice.json"</span>), resource_paths<span style="color: #333333">.</span>rawfiles[<span style="color: #0000DD; font-weight: bold">0</span>])

    <span style="color: #008800; font-weight: bold">with</span> contextlib<span style="color: #333333">.</span>suppress(<span style="color: #FF0000; font-weight: bold">Exception</span>):
        update_description_with_features(
            resource_paths,
            resource_paths<span style="color: #333333">.</span>invoice<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"invoice.json"</span>),
            srcpaths<span style="color: #333333">.</span>tasksupport<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"metadata-def.json"</span>),
        )

    <span style="color: #888888"># validate metadata.json</span>
    <span style="color: #008800; font-weight: bold">if</span> resource_paths<span style="color: #333333">.</span>meta<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"metadata.json"</span>)<span style="color: #333333">.</span>exists():
        metadata_validate(resource_paths<span style="color: #333333">.</span>meta<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"metadata.json"</span>))

    <span style="color: #888888"># validate invoice.schema.json / invoice.json</span>
    schema_path <span style="color: #333333">=</span> srcpaths<span style="color: #333333">.</span>tasksupport<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"invoice.schema.json"</span>)
    invoice_validate(resource_paths<span style="color: #333333">.</span>invoice<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"invoice.json"</span>), schema_path)

    invoice <span style="color: #333333">=</span> InvoiceFile(resource_paths<span style="color: #333333">.</span>invoice<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"invoice.json"</span>))
    basedir <span style="color: #333333">=</span> resource_paths<span style="color: #333333">.</span>rawfiles[<span style="color: #0000DD; font-weight: bold">0</span>]<span style="color: #333333">.</span>parent <span style="color: #008800; font-weight: bold">if</span> <span style="color: #007020">len</span>(resource_paths<span style="color: #333333">.</span>rawfiles) <span style="color: #333333">&gt;</span> <span style="color: #0000DD; font-weight: bold">0</span> <span style="color: #008800; font-weight: bold">else</span> <span style="background-color: #fff0f0">""</span>
    <span style="color: #008800; font-weight: bold">return</span> WorkflowExecutionStatus(
        run_id<span style="color: #333333">=</span>index,
        title<span style="color: #333333">=</span>invoice<span style="color: #333333">.</span>invoice_obj<span style="color: #333333">.</span>get(<span style="background-color: #fff0f0">"basic"</span>, {})<span style="color: #333333">.</span>get(<span style="background-color: #fff0f0">"dataName"</span>, <span style="background-color: #fff0f0">"Invoice Mode Process"</span>),
        status<span style="color: #333333">=</span><span style="background-color: #fff0f0">"success"</span>,
        mode<span style="color: #333333">=</span><span style="background-color: #fff0f0">"invoice"</span>,
        error_code<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">None</span>,
        error_message<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">None</span>,
        target<span style="color: #333333">=</span><span style="color: #007020">str</span>(basedir),
        stacktrace<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">None</span>,
    )
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><h2 id="excel_invoice_mode_process">excel_invoice_mode_process</h2>
<div class="doc doc-object doc-function">
<div class="doc doc-contents first">
<p>Processes invoice data from an Excel file and applies dataset transformations using the provided callback function.</p>
<p>This function performs several steps:</p>
<ol>
<li>Overwrites the Excel invoice file.</li>
<li>Copies input files to the rawfile directory.</li>
<li>Runs a custom dataset process function if provided.</li>
<li>Replaces the placeholder '${filename}' in the invoice with the actual filename if necessary.</li>
<li>Copies images to the thumbnail directory.</li>
<li>Attempts to update descriptions with features, ignoring any errors during this step.</li>
<li>Validates the metadata-def.json file.</li>
<li>Validates the invoice file against the invoice schema.</li>
</ol>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code>srcpaths</code></td>
<td>
<code><span title="rdetoolkit.models.rde2types.RdeInputDirPaths">RdeInputDirPaths</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Input paths for the source data.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>resource_paths</code></td>
<td>
<code><span title="rdetoolkit.models.rde2types.RdeOutputResourcePath">RdeOutputResourcePath</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Paths to the resources where data will be written or read from.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>excel_invoice_file</code></td>
<td>
<code><span title="pathlib.Path">Path</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Path to the source Excel invoice file.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>idx</code></td>
<td>
<code>int</code>
</td>
<td>
<div class="doc-md-description">
<p>Index or identifier for the data being processed.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>datasets_process_function</code></td>
<td>
<code><span title="src.rdetoolkit.modeproc._CallbackType">_CallbackType</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A callback function that processes datasets. Defaults to None.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
<tr class="doc-section-item">
<td><code>config</code></td>
<td>
<code>Config</code>
</td>
<td>
<div class="doc-md-description">
<p>Configuration instance for structured processing execution. Defaults to None.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Raises:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="rdetoolkit.exceptions.StructuredError">StructuredError</span></code>
</td>
<td>
<div class="doc-md-description">
<p>When encountering issues related to Excel invoice overwriting or during the validation steps.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Name</th> <th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code>WorkflowExecutionStatus</code></td> <td>
<code><span title="rdetoolkit.models.result.WorkflowExecutionStatus">WorkflowExecutionStatus</span></code>
</td>
<td>
<div class="doc-md-description">
<p>An object containing the execution status of the workflow, including:
- run_id (str): The unique identifier for the workflow execution, zero-padded to four digits.
- title (str): A descriptive title for the workflow execution.
- status (str): The status of the workflow execution, either "success" or "failed".
- mode (str): The mode in which the workflow was executed, e.g., "rdeformat".
- error_code (int | None): The error code if an error occurred, otherwise None.
- error_message (str | None): The error message if an error occurred, otherwise None.
- target (str): The target directory or file path related to the workflow execution.</p>
</div>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>src/rdetoolkit/modeproc.py</code></summary>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">193</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">194</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">195</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">196</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">197</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">198</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">199</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">200</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">201</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">202</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">203</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">204</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">205</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">206</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">207</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">208</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">209</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">210</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">211</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">212</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">213</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">214</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">215</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">216</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">217</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">218</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">219</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">220</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">221</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">222</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">223</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">224</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">225</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">226</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">227</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">228</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">229</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">230</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">231</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">232</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">233</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">234</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">235</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">236</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">237</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">238</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">239</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">240</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">241</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">242</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">243</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">244</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">245</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">246</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">247</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">248</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">249</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">250</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">251</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">252</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">253</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">254</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">255</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">256</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">257</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">258</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">259</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">260</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">261</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">262</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">263</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">264</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">265</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">266</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">267</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">268</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">269</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">270</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">271</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">272</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">273</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">274</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">275</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">276</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">277</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">278</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">279</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">280</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">281</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">282</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">283</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">284</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">285</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">286</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">287</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">288</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">289</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">290</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">291</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">292</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">293</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">294</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">295</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">296</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">297</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">298</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">excel_invoice_mode_process</span>(
    srcpaths: RdeInputDirPaths,
    resource_paths: RdeOutputResourcePath,
    excel_invoice_file: Path,
    idx: <span style="color: #007020">int</span>,
    datasets_process_function: _CallbackType <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">None</span>,
) <span style="color: #333333">-&gt;</span> WorkflowExecutionStatus:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Processes invoice data from an Excel file and applies dataset transformations using the provided callback function.</span>

<span style="color: #DD4422">    This function performs several steps:</span>

<span style="color: #DD4422">    1. Overwrites the Excel invoice file.</span>
<span style="color: #DD4422">    2. Copies input files to the rawfile directory.</span>
<span style="color: #DD4422">    3. Runs a custom dataset process function if provided.</span>
<span style="color: #DD4422">    4. Replaces the placeholder '${filename}' in the invoice with the actual filename if necessary.</span>
<span style="color: #DD4422">    5. Copies images to the thumbnail directory.</span>
<span style="color: #DD4422">    6. Attempts to update descriptions with features, ignoring any errors during this step.</span>
<span style="color: #DD4422">    7. Validates the metadata-def.json file.</span>
<span style="color: #DD4422">    8. Validates the invoice file against the invoice schema.</span>

<span style="color: #DD4422">    Args:</span>
<span style="color: #DD4422">        srcpaths (RdeInputDirPaths): Input paths for the source data.</span>
<span style="color: #DD4422">        resource_paths (RdeOutputResourcePath): Paths to the resources where data will be written or read from.</span>
<span style="color: #DD4422">        excel_invoice_file (Path): Path to the source Excel invoice file.</span>
<span style="color: #DD4422">        idx (int): Index or identifier for the data being processed.</span>
<span style="color: #DD4422">        datasets_process_function (_CallbackType, optional): A callback function that processes datasets. Defaults to None.</span>
<span style="color: #DD4422">        config (Config, optional): Configuration instance for structured processing execution. Defaults to None.</span>

<span style="color: #DD4422">    Raises:</span>
<span style="color: #DD4422">        StructuredError: When encountering issues related to Excel invoice overwriting or during the validation steps.</span>
<span style="color: #DD4422">        Any exceptions raised by `datasets_process_function` will propagate upwards. Exceptions during the `update_description_with_features` step are caught and silently ignored.</span>

<span style="color: #DD4422">    Returns:</span>
<span style="color: #DD4422">        WorkflowExecutionStatus: An object containing the execution status of the workflow, including:</span>
<span style="color: #DD4422">            - run_id (str): The unique identifier for the workflow execution, zero-padded to four digits.</span>
<span style="color: #DD4422">            - title (str): A descriptive title for the workflow execution.</span>
<span style="color: #DD4422">            - status (str): The status of the workflow execution, either "success" or "failed".</span>
<span style="color: #DD4422">            - mode (str): The mode in which the workflow was executed, e.g., "rdeformat".</span>
<span style="color: #DD4422">            - error_code (int | None): The error code if an error occurred, otherwise None.</span>
<span style="color: #DD4422">            - error_message (str | None): The error message if an error occurred, otherwise None.</span>
<span style="color: #DD4422">            - target (str): The target directory or file path related to the workflow execution.</span>
<span style="color: #DD4422">    """</span>
    <span style="color: #888888"># rewriting the invoice</span>
    excel_invoice <span style="color: #333333">=</span> ExcelInvoiceFile(excel_invoice_file)
    <span style="color: #008800; font-weight: bold">try</span>:
        excel_invoice<span style="color: #333333">.</span>overwrite(
            resource_paths<span style="color: #333333">.</span>invoice_org,
            resource_paths<span style="color: #333333">.</span>invoice<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"invoice.json"</span>),
            resource_paths<span style="color: #333333">.</span>invoice_schema_json,
            idx,
        )
    <span style="color: #008800; font-weight: bold">except</span> StructuredError:
        <span style="color: #008800; font-weight: bold">raise</span>
    <span style="color: #008800; font-weight: bold">except</span> <span style="color: #FF0000; font-weight: bold">Exception</span> <span style="color: #008800; font-weight: bold">as</span> e:
        emsg <span style="color: #333333">=</span> <span style="background-color: #fff0f0">f"ERROR: failed to generate invoice file for data </span><span style="background-color: #eeeeee">{</span>idx<span style="background-color: #eeeeee">:</span><span style="background-color: #fff0f0">04d</span><span style="background-color: #eeeeee">}</span><span style="background-color: #fff0f0">"</span>
        <span style="color: #008800; font-weight: bold">raise</span> StructuredError(
            emsg,
            eobj<span style="color: #333333">=</span>e,
        ) <span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">e</span>

    <span style="color: #008800; font-weight: bold">if</span> srcpaths<span style="color: #333333">.</span>config<span style="color: #333333">.</span>system<span style="color: #333333">.</span>save_raw:
        copy_input_to_rawfile(resource_paths<span style="color: #333333">.</span>raw, resource_paths<span style="color: #333333">.</span>rawfiles)

    <span style="color: #008800; font-weight: bold">if</span> srcpaths<span style="color: #333333">.</span>config<span style="color: #333333">.</span>system<span style="color: #333333">.</span>save_nonshared_raw:
        copy_input_to_rawfile(resource_paths<span style="color: #333333">.</span>nonshared_raw, resource_paths<span style="color: #333333">.</span>rawfiles)

    <span style="color: #888888"># run custom dataset process</span>
    <span style="color: #008800; font-weight: bold">if</span> datasets_process_function <span style="color: #000000; font-weight: bold">is</span> <span style="color: #000000; font-weight: bold">not</span> <span style="color: #008800; font-weight: bold">None</span>:
        datasets_process_function(srcpaths, resource_paths)

    <span style="color: #888888"># rewriting support for ${filename} by default</span>
    <span style="color: #888888"># Excelinvoice applies to file mode only, folder mode is not supported.</span>
    <span style="color: #888888"># FileMode has only one element in resource_paths.rawfiles.</span>
    <span style="color: #008800; font-weight: bold">if</span> srcpaths<span style="color: #333333">.</span>config<span style="color: #333333">.</span>system<span style="color: #333333">.</span>magic_variable:
        apply_magic_variable(resource_paths<span style="color: #333333">.</span>invoice<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"invoice.json"</span>), resource_paths<span style="color: #333333">.</span>rawfiles[<span style="color: #0000DD; font-weight: bold">0</span>])

    <span style="color: #008800; font-weight: bold">if</span> srcpaths<span style="color: #333333">.</span>config<span style="color: #333333">.</span>system<span style="color: #333333">.</span>save_thumbnail_image:
        img2thumb<span style="color: #333333">.</span>copy_images_to_thumbnail(resource_paths<span style="color: #333333">.</span>thumbnail, resource_paths<span style="color: #333333">.</span>main_image)

    <span style="color: #008800; font-weight: bold">with</span> contextlib<span style="color: #333333">.</span>suppress(<span style="color: #FF0000; font-weight: bold">Exception</span>):
        update_description_with_features(
            resource_paths,
            resource_paths<span style="color: #333333">.</span>invoice<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"invoice.json"</span>),
            srcpaths<span style="color: #333333">.</span>tasksupport<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"metadata-def.json"</span>),
        )

    <span style="color: #888888"># validate metadata.json</span>
    <span style="color: #008800; font-weight: bold">if</span> resource_paths<span style="color: #333333">.</span>meta<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"metadata.json"</span>)<span style="color: #333333">.</span>exists():
        metadata_validate(resource_paths<span style="color: #333333">.</span>meta<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"metadata.json"</span>))

    <span style="color: #888888"># validate invoice.schema.json / invoice.json</span>
    schema_path <span style="color: #333333">=</span> srcpaths<span style="color: #333333">.</span>tasksupport<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"invoice.schema.json"</span>)
    invoice_validate(resource_paths<span style="color: #333333">.</span>invoice<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"invoice.json"</span>), schema_path)

    invoice <span style="color: #333333">=</span> InvoiceFile(resource_paths<span style="color: #333333">.</span>invoice<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"invoice.json"</span>))
    basedir <span style="color: #333333">=</span> resource_paths<span style="color: #333333">.</span>rawfiles[<span style="color: #0000DD; font-weight: bold">0</span>]<span style="color: #333333">.</span>parent <span style="color: #008800; font-weight: bold">if</span> <span style="color: #007020">len</span>(resource_paths<span style="color: #333333">.</span>rawfiles) <span style="color: #333333">&gt;</span> <span style="color: #0000DD; font-weight: bold">0</span> <span style="color: #008800; font-weight: bold">else</span> <span style="background-color: #fff0f0">""</span>
    <span style="color: #008800; font-weight: bold">return</span> WorkflowExecutionStatus(
        run_id<span style="color: #333333">=</span><span style="color: #007020">str</span>(idx),
        title<span style="color: #333333">=</span>invoice<span style="color: #333333">.</span>invoice_obj<span style="color: #333333">.</span>get(<span style="background-color: #fff0f0">"basic"</span>, {})<span style="color: #333333">.</span>get(<span style="background-color: #fff0f0">"dataName"</span>, <span style="background-color: #fff0f0">"Excelinvoice Mode Process"</span>),
        status<span style="color: #333333">=</span><span style="background-color: #fff0f0">"success"</span>,
        mode<span style="color: #333333">=</span><span style="background-color: #fff0f0">"Excelinvoice"</span>,
        error_code<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">None</span>,
        error_message<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">None</span>,
        target<span style="color: #333333">=</span><span style="color: #007020">str</span>(basedir),
        stacktrace<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">None</span>,
    )
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><h2 id="rdeformat_mode_process">rdeformat_mode_process</h2>
<div class="doc doc-object doc-function">
<div class="doc doc-contents first">
<p>Process the source data and apply specific transformations using the provided callback function.</p>
<p>This function performs several steps:</p>
<ol>
<li>Overwrites the invoice file.</li>
<li>Copies input files to the rawfile directory.</li>
<li>Runs a custom dataset process function if provided.</li>
<li>Copies images to the thumbnail directory.</li>
<li>Updates descriptions with features, ignoring any errors during this step.</li>
<li>Validates the metadata-def.json file.</li>
<li>Validates the invoice file against the invoice schema.</li>
</ol>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code>index</code></td>
<td>
<code>str</code>
</td>
<td>
<div class="doc-md-description">
<p>The workflow execution ID (run_id) is a unique identifier used to distinguish a specific execution of a workflow.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>srcpaths</code></td>
<td>
<code><span title="rdetoolkit.models.rde2types.RdeInputDirPaths">RdeInputDirPaths</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Input paths for the source data.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>resource_paths</code></td>
<td>
<code><span title="rdetoolkit.models.rde2types.RdeOutputResourcePath">RdeOutputResourcePath</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Paths to the resources where data will be written or read from.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>datasets_process_function</code></td>
<td>
<code><span title="src.rdetoolkit.modeproc._CallbackType">_CallbackType</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A callback function that processes datasets. Defaults to None.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
<tr class="doc-section-item">
<td><code>config</code></td>
<td>
<code>Config</code>
</td>
<td>
<div class="doc-md-description">
<p>Configuration instance for structured processing execution. Defaults to None.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Name</th> <th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code>WorkflowExecutionStatus</code></td> <td>
<code><span title="rdetoolkit.models.result.WorkflowExecutionStatus">WorkflowExecutionStatus</span></code>
</td>
<td>
<div class="doc-md-description">
<p>An object containing the execution status of the workflow, including:
- run_id (str): The unique identifier for the workflow execution, zero-padded to four digits.
- title (str): A descriptive title for the workflow execution.
- status (str): The status of the workflow execution, either "success" or "failed".
- mode (str): The mode in which the workflow was executed, e.g., "rdeformat".
- error_code (int | None): The error code if an error occurred, otherwise None.
- error_message (str | None): The error message if an error occurred, otherwise None.
- target (str): The target directory or file path related to the workflow execution.</p>
</div>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>src/rdetoolkit/modeproc.py</code></summary>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 30</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 31</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 32</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 33</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 34</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 35</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 36</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 37</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 38</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 39</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 40</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 41</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 42</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 43</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 44</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 45</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 46</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 47</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 48</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 49</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 50</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 51</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 52</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 53</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 54</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 55</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 56</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 57</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 58</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 59</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 60</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 61</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 62</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 63</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 64</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 65</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 66</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 67</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 68</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 69</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 70</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 71</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 72</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 73</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 74</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 75</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 76</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 77</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 78</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 79</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 80</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 81</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 82</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 83</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 84</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 85</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 86</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 87</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 88</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 89</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 90</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 91</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 92</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 93</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 94</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 95</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 96</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 97</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 98</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 99</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">100</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">101</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">102</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">103</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">104</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">105</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">106</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">rdeformat_mode_process</span>(
    index: <span style="color: #007020">str</span>,
    srcpaths: RdeInputDirPaths,
    resource_paths: RdeOutputResourcePath,
    datasets_process_function: _CallbackType <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">None</span>,
) <span style="color: #333333">-&gt;</span> WorkflowExecutionStatus:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Process the source data and apply specific transformations using the provided callback function.</span>

<span style="color: #DD4422">    This function performs several steps:</span>

<span style="color: #DD4422">    1. Overwrites the invoice file.</span>
<span style="color: #DD4422">    2. Copies input files to the rawfile directory.</span>
<span style="color: #DD4422">    3. Runs a custom dataset process function if provided.</span>
<span style="color: #DD4422">    4. Copies images to the thumbnail directory.</span>
<span style="color: #DD4422">    5. Updates descriptions with features, ignoring any errors during this step.</span>
<span style="color: #DD4422">    6. Validates the metadata-def.json file.</span>
<span style="color: #DD4422">    7. Validates the invoice file against the invoice schema.</span>

<span style="color: #DD4422">    Args:</span>
<span style="color: #DD4422">        index: The workflow execution ID (run_id) is a unique identifier used to distinguish a specific execution of a workflow.</span>
<span style="color: #DD4422">        srcpaths (RdeInputDirPaths): Input paths for the source data.</span>
<span style="color: #DD4422">        resource_paths (RdeOutputResourcePath): Paths to the resources where data will be written or read from.</span>
<span style="color: #DD4422">        datasets_process_function (_CallbackType, optional): A callback function that processes datasets. Defaults to None.</span>
<span style="color: #DD4422">        config (Config, optional): Configuration instance for structured processing execution. Defaults to None.</span>

<span style="color: #DD4422">    Raises:</span>
<span style="color: #DD4422">        Any exceptions raised by `datasets_process_function` or during the validation steps will propagate upwards. Exceptions during the `update_description_with_features` step are caught and silently ignored.</span>

<span style="color: #DD4422">    Returns:</span>
<span style="color: #DD4422">        WorkflowExecutionStatus: An object containing the execution status of the workflow, including:</span>
<span style="color: #DD4422">            - run_id (str): The unique identifier for the workflow execution, zero-padded to four digits.</span>
<span style="color: #DD4422">            - title (str): A descriptive title for the workflow execution.</span>
<span style="color: #DD4422">            - status (str): The status of the workflow execution, either "success" or "failed".</span>
<span style="color: #DD4422">            - mode (str): The mode in which the workflow was executed, e.g., "rdeformat".</span>
<span style="color: #DD4422">            - error_code (int | None): The error code if an error occurred, otherwise None.</span>
<span style="color: #DD4422">            - error_message (str | None): The error message if an error occurred, otherwise None.</span>
<span style="color: #DD4422">            - target (str): The target directory or file path related to the workflow execution.</span>
<span style="color: #DD4422">    """</span>
    basedir <span style="color: #333333">=</span> resource_paths<span style="color: #333333">.</span>rawfiles[<span style="color: #0000DD; font-weight: bold">0</span>]<span style="color: #333333">.</span>parent <span style="color: #008800; font-weight: bold">if</span> <span style="color: #007020">len</span>(resource_paths<span style="color: #333333">.</span>rawfiles) <span style="color: #333333">&gt;</span> <span style="color: #0000DD; font-weight: bold">0</span> <span style="color: #008800; font-weight: bold">else</span> <span style="background-color: #fff0f0">""</span>

    <span style="color: #888888"># rewriting the invoice</span>
    invoice_dst_filepath <span style="color: #333333">=</span> resource_paths<span style="color: #333333">.</span>invoice<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"invoice.json"</span>)
    InvoiceFile<span style="color: #333333">.</span>copy_original_invoice(resource_paths<span style="color: #333333">.</span>invoice_org, invoice_dst_filepath)
    copy_input_to_rawfile_for_rdeformat(resource_paths)
    invoice <span style="color: #333333">=</span> InvoiceFile(invoice_dst_filepath)

    <span style="color: #888888"># run custom dataset process</span>
    <span style="color: #008800; font-weight: bold">if</span> datasets_process_function <span style="color: #000000; font-weight: bold">is</span> <span style="color: #000000; font-weight: bold">not</span> <span style="color: #008800; font-weight: bold">None</span>:
        datasets_process_function(srcpaths, resource_paths)

    <span style="color: #008800; font-weight: bold">if</span> srcpaths<span style="color: #333333">.</span>config<span style="color: #333333">.</span>system<span style="color: #333333">.</span>save_thumbnail_image:
        img2thumb<span style="color: #333333">.</span>copy_images_to_thumbnail(
            resource_paths<span style="color: #333333">.</span>thumbnail,
            resource_paths<span style="color: #333333">.</span>main_image,
        )

    <span style="color: #008800; font-weight: bold">with</span> contextlib<span style="color: #333333">.</span>suppress(<span style="color: #FF0000; font-weight: bold">Exception</span>):
        update_description_with_features(resource_paths, invoice_dst_filepath, srcpaths<span style="color: #333333">.</span>tasksupport<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"metadata-def.json"</span>))

    <span style="color: #888888"># validate metadata.json</span>
    <span style="color: #008800; font-weight: bold">if</span> resource_paths<span style="color: #333333">.</span>meta<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"metadata.json"</span>)<span style="color: #333333">.</span>exists():
        metadata_validate(resource_paths<span style="color: #333333">.</span>meta<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"metadata.json"</span>))

    <span style="color: #888888"># validate invoice.schema.json / invoice.json</span>
    schema_path <span style="color: #333333">=</span> srcpaths<span style="color: #333333">.</span>tasksupport<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"invoice.schema.json"</span>)
    invoice_validate(invoice_dst_filepath, schema_path)

    <span style="color: #008800; font-weight: bold">return</span> WorkflowExecutionStatus(
        run_id<span style="color: #333333">=</span>index,
        title<span style="color: #333333">=</span>invoice<span style="color: #333333">.</span>invoice_obj<span style="color: #333333">.</span>get(<span style="background-color: #fff0f0">"basic"</span>, {})<span style="color: #333333">.</span>get(<span style="background-color: #fff0f0">"dataName"</span>, <span style="background-color: #fff0f0">"RDEFormat Mode Process"</span>),
        status<span style="color: #333333">=</span><span style="background-color: #fff0f0">"success"</span>,
        mode<span style="color: #333333">=</span><span style="background-color: #fff0f0">"rdeformat"</span>,
        error_code<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">None</span>,
        error_message<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">None</span>,
        target<span style="color: #333333">=</span><span style="color: #007020">str</span>(basedir),
        stacktrace<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">None</span>,
    )
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><h2 id="copy_input_to_rawfile_for_rdeformat">copy_input_to_rawfile_for_rdeformat</h2>
<div class="doc doc-object doc-function">
<div class="doc doc-contents first">
<p>Copy the input raw files to their respective directories based on the file's part names.</p>
<p>This function scans through the parts of each file's path in <code>resource_paths.rawfiles</code>. If the file path
contains a directory name listed in the <code>directories</code> dict, the file will be copied to the corresponding
directory.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code>resource_paths</code></td>
<td>
<code><span title="rdetoolkit.models.rde2types.RdeOutputResourcePath">RdeOutputResourcePath</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Paths to the resources where data will be written or read from.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>None</code>
</td>
<td>
<div class="doc-md-description">
<p>None</p>
</div>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>src/rdetoolkit/modeproc.py</code></summary>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">385</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">386</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">387</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">388</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">389</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">390</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">391</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">392</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">393</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">394</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">395</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">396</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">397</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">398</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">399</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">400</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">401</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">402</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">403</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">404</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">405</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">406</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">407</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">408</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">409</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">410</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">411</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">copy_input_to_rawfile_for_rdeformat</span>(resource_paths: RdeOutputResourcePath) <span style="color: #333333">-&gt;</span> <span style="color: #008800; font-weight: bold">None</span>:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Copy the input raw files to their respective directories based on the file's part names.</span>

<span style="color: #DD4422">    This function scans through the parts of each file's path in `resource_paths.rawfiles`. If the file path</span>
<span style="color: #DD4422">    contains a directory name listed in the `directories` dict, the file will be copied to the corresponding</span>
<span style="color: #DD4422">    directory.</span>

<span style="color: #DD4422">    Args:</span>
<span style="color: #DD4422">        resource_paths (RdeOutputResourcePath): Paths to the resources where data will be written or read from.</span>

<span style="color: #DD4422">    Returns:</span>
<span style="color: #DD4422">        None</span>
<span style="color: #DD4422">    """</span>
    directories <span style="color: #333333">=</span> {
        <span style="background-color: #fff0f0">"raw"</span>: resource_paths<span style="color: #333333">.</span>raw,
        <span style="background-color: #fff0f0">"main_image"</span>: resource_paths<span style="color: #333333">.</span>main_image,
        <span style="background-color: #fff0f0">"other_image"</span>: resource_paths<span style="color: #333333">.</span>other_image,
        <span style="background-color: #fff0f0">"meta"</span>: resource_paths<span style="color: #333333">.</span>meta,
        <span style="background-color: #fff0f0">"structured"</span>: resource_paths<span style="color: #333333">.</span>struct,
        <span style="background-color: #fff0f0">"logs"</span>: resource_paths<span style="color: #333333">.</span>logs,
        <span style="background-color: #fff0f0">"nonshared_raw"</span>: resource_paths<span style="color: #333333">.</span>nonshared_raw,
    }
    <span style="color: #008800; font-weight: bold">for</span> f <span style="color: #000000; font-weight: bold">in</span> resource_paths<span style="color: #333333">.</span>rawfiles:
        <span style="color: #008800; font-weight: bold">for</span> dir_name, directory <span style="color: #000000; font-weight: bold">in</span> directories<span style="color: #333333">.</span>items():
            <span style="color: #008800; font-weight: bold">if</span> dir_name <span style="color: #000000; font-weight: bold">in</span> f<span style="color: #333333">.</span>parts:
                shutil<span style="color: #333333">.</span>copy(f, os<span style="color: #333333">.</span>path<span style="color: #333333">.</span>join(<span style="color: #007020">str</span>(directory), f<span style="color: #333333">.</span>name))
                <span style="color: #008800; font-weight: bold">break</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><h2 id="multifile_mode_process">multifile_mode_process</h2>
<div class="doc doc-object doc-function">
<div class="doc doc-contents first">
<p>Processes multiple source files and applies transformations using the provided callback function.</p>
<p>This function performs several steps:</p>
<ol>
<li>Overwrites the invoice file.</li>
<li>Copies input files to the rawfile directory.</li>
<li>Runs a custom dataset process function if provided.</li>
<li>Replaces the placeholder '${filename}' in the invoice with the actual filename if necessary.</li>
<li>Copies images to the thumbnail directory.</li>
<li>Attempts to update descriptions with features, ignoring any errors during this step.</li>
<li>Validates the metadata-def.json file.</li>
<li>Validates the invoice file against the invoice schema.</li>
</ol>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code>index</code></td>
<td>
<code>str</code>
</td>
<td>
<div class="doc-md-description">
<p>The workflow execution ID (run_id) is a unique identifier used to distinguish a specific execution of a workflow.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>srcpaths</code></td>
<td>
<code><span title="rdetoolkit.models.rde2types.RdeInputDirPaths">RdeInputDirPaths</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Input paths for the source data.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>resource_paths</code></td>
<td>
<code><span title="rdetoolkit.models.rde2types.RdeOutputResourcePath">RdeOutputResourcePath</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Paths to the resources where data will be written or read from.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>datasets_process_function</code></td>
<td>
<code><span title="src.rdetoolkit.modeproc._CallbackType">_CallbackType</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A callback function that processes datasets. Defaults to None.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
<tr class="doc-section-item">
<td><code>config</code></td>
<td>
<code>Config</code>
</td>
<td>
<div class="doc-md-description">
<p>Configuration instance for structured processing execution. Defaults to None.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Name</th> <th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code>WorkflowExecutionStatus</code></td> <td>
<code><span title="rdetoolkit.models.result.WorkflowExecutionStatus">WorkflowExecutionStatus</span></code>
</td>
<td>
<div class="doc-md-description">
<p>An object containing the execution status of the workflow, including:
- run_id (str): The unique identifier for the workflow execution, zero-padded to four digits.
- title (str): A descriptive title for the workflow execution.
- status (str): The status of the workflow execution, either "success" or "failed".
- mode (str): The mode in which the workflow was executed, e.g., "rdeformat".
- error_code (int | None): The error code if an error occurred, otherwise None.
- error_message (str | None): The error message if an error occurred, otherwise None.
- target (str): The target directory or file path related to the workflow execution.</p>
</div>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>src/rdetoolkit/modeproc.py</code></summary>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">109</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">110</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">111</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">112</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">113</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">114</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">115</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">116</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">117</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">118</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">119</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">120</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">121</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">122</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">123</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">124</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">125</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">126</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">127</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">128</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">129</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">130</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">131</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">132</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">133</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">134</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">135</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">136</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">137</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">138</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">139</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">140</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">141</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">142</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">143</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">144</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">145</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">146</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">147</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">148</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">149</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">150</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">151</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">152</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">153</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">154</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">155</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">156</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">157</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">158</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">159</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">160</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">161</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">162</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">163</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">164</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">165</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">166</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">167</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">168</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">169</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">170</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">171</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">172</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">173</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">174</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">175</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">176</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">177</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">178</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">179</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">180</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">181</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">182</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">183</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">184</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">185</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">186</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">187</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">188</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">189</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">190</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">multifile_mode_process</span>(
    index: <span style="color: #007020">str</span>,
    srcpaths: RdeInputDirPaths,
    resource_paths: RdeOutputResourcePath,
    datasets_process_function: _CallbackType <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">None</span>,
) <span style="color: #333333">-&gt;</span> WorkflowExecutionStatus:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Processes multiple source files and applies transformations using the provided callback function.</span>

<span style="color: #DD4422">    This function performs several steps:</span>

<span style="color: #DD4422">    1. Overwrites the invoice file.</span>
<span style="color: #DD4422">    2. Copies input files to the rawfile directory.</span>
<span style="color: #DD4422">    3. Runs a custom dataset process function if provided.</span>
<span style="color: #DD4422">    4. Replaces the placeholder '${filename}' in the invoice with the actual filename if necessary.</span>
<span style="color: #DD4422">    5. Copies images to the thumbnail directory.</span>
<span style="color: #DD4422">    6. Attempts to update descriptions with features, ignoring any errors during this step.</span>
<span style="color: #DD4422">    7. Validates the metadata-def.json file.</span>
<span style="color: #DD4422">    8. Validates the invoice file against the invoice schema.</span>

<span style="color: #DD4422">    Args:</span>
<span style="color: #DD4422">        index: The workflow execution ID (run_id) is a unique identifier used to distinguish a specific execution of a workflow.</span>
<span style="color: #DD4422">        srcpaths (RdeInputDirPaths): Input paths for the source data.</span>
<span style="color: #DD4422">        resource_paths (RdeOutputResourcePath): Paths to the resources where data will be written or read from.</span>
<span style="color: #DD4422">        datasets_process_function (_CallbackType, optional): A callback function that processes datasets. Defaults to None.</span>
<span style="color: #DD4422">        config (Config, optional): Configuration instance for structured processing execution. Defaults to None.</span>

<span style="color: #DD4422">    Raises:</span>
<span style="color: #DD4422">        Any exceptions raised by `datasets_process_function` or during the validation steps will propagate upwards. Exceptions during the `update_description_with_features` step are caught and silently ignored.</span>

<span style="color: #DD4422">    Returns:</span>
<span style="color: #DD4422">        WorkflowExecutionStatus: An object containing the execution status of the workflow, including:</span>
<span style="color: #DD4422">            - run_id (str): The unique identifier for the workflow execution, zero-padded to four digits.</span>
<span style="color: #DD4422">            - title (str): A descriptive title for the workflow execution.</span>
<span style="color: #DD4422">            - status (str): The status of the workflow execution, either "success" or "failed".</span>
<span style="color: #DD4422">            - mode (str): The mode in which the workflow was executed, e.g., "rdeformat".</span>
<span style="color: #DD4422">            - error_code (int | None): The error code if an error occurred, otherwise None.</span>
<span style="color: #DD4422">            - error_message (str | None): The error message if an error occurred, otherwise None.</span>
<span style="color: #DD4422">            - target (str): The target directory or file path related to the workflow execution.</span>
<span style="color: #DD4422">    """</span>
    basedir <span style="color: #333333">=</span> resource_paths<span style="color: #333333">.</span>rawfiles[<span style="color: #0000DD; font-weight: bold">0</span>]<span style="color: #333333">.</span>parent <span style="color: #008800; font-weight: bold">if</span> <span style="color: #007020">len</span>(resource_paths<span style="color: #333333">.</span>rawfiles) <span style="color: #333333">&gt;</span> <span style="color: #0000DD; font-weight: bold">0</span> <span style="color: #008800; font-weight: bold">else</span> <span style="background-color: #fff0f0">""</span>
    invoice_dst_filepath <span style="color: #333333">=</span> resource_paths<span style="color: #333333">.</span>invoice<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"invoice.json"</span>)
    InvoiceFile<span style="color: #333333">.</span>copy_original_invoice(resource_paths<span style="color: #333333">.</span>invoice_org, invoice_dst_filepath)
    invoice <span style="color: #333333">=</span> InvoiceFile(invoice_dst_filepath)

    <span style="color: #008800; font-weight: bold">if</span> srcpaths<span style="color: #333333">.</span>config<span style="color: #333333">.</span>system<span style="color: #333333">.</span>save_raw:
        copy_input_to_rawfile(resource_paths<span style="color: #333333">.</span>raw, resource_paths<span style="color: #333333">.</span>rawfiles)

    <span style="color: #008800; font-weight: bold">if</span> srcpaths<span style="color: #333333">.</span>config<span style="color: #333333">.</span>system<span style="color: #333333">.</span>save_nonshared_raw:
        copy_input_to_rawfile(resource_paths<span style="color: #333333">.</span>nonshared_raw, resource_paths<span style="color: #333333">.</span>rawfiles)

    <span style="color: #888888"># run custom dataset process</span>
    <span style="color: #008800; font-weight: bold">if</span> datasets_process_function <span style="color: #000000; font-weight: bold">is</span> <span style="color: #000000; font-weight: bold">not</span> <span style="color: #008800; font-weight: bold">None</span>:
        datasets_process_function(srcpaths, resource_paths)

    <span style="color: #888888"># rewriting support for ${filename} by default</span>
    <span style="color: #008800; font-weight: bold">if</span> srcpaths<span style="color: #333333">.</span>config<span style="color: #333333">.</span>system<span style="color: #333333">.</span>magic_variable:
        apply_magic_variable(resource_paths<span style="color: #333333">.</span>invoice<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"invoice.json"</span>), resource_paths<span style="color: #333333">.</span>rawfiles[<span style="color: #0000DD; font-weight: bold">0</span>])

    <span style="color: #008800; font-weight: bold">if</span> srcpaths<span style="color: #333333">.</span>config<span style="color: #333333">.</span>system<span style="color: #333333">.</span>save_thumbnail_image:
        img2thumb<span style="color: #333333">.</span>copy_images_to_thumbnail(resource_paths<span style="color: #333333">.</span>thumbnail, resource_paths<span style="color: #333333">.</span>main_image)

    <span style="color: #008800; font-weight: bold">with</span> contextlib<span style="color: #333333">.</span>suppress(<span style="color: #FF0000; font-weight: bold">Exception</span>):
        update_description_with_features(resource_paths, invoice_dst_filepath, srcpaths<span style="color: #333333">.</span>tasksupport<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"metadata-def.json"</span>))

    <span style="color: #888888"># validate metadata.json</span>
    <span style="color: #008800; font-weight: bold">if</span> resource_paths<span style="color: #333333">.</span>meta<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"metadata.json"</span>)<span style="color: #333333">.</span>exists():
        metadata_validate(resource_paths<span style="color: #333333">.</span>meta<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"metadata.json"</span>))

    <span style="color: #888888"># validate invoice.schema.json / invoice.json</span>
    schema_path <span style="color: #333333">=</span> srcpaths<span style="color: #333333">.</span>tasksupport<span style="color: #333333">.</span>joinpath(<span style="background-color: #fff0f0">"invoice.schema.json"</span>)
    invoice_validate(invoice_dst_filepath, schema_path)

    <span style="color: #008800; font-weight: bold">return</span> WorkflowExecutionStatus(
        run_id<span style="color: #333333">=</span>index,
        title<span style="color: #333333">=</span>invoice<span style="color: #333333">.</span>invoice_obj<span style="color: #333333">.</span>get(<span style="background-color: #fff0f0">"basic"</span>, {})<span style="color: #333333">.</span>get(<span style="background-color: #fff0f0">"dataName"</span>, <span style="background-color: #fff0f0">"MultiDataTile Mode Process"</span>),
        status<span style="color: #333333">=</span><span style="background-color: #fff0f0">"success"</span>,
        mode<span style="color: #333333">=</span><span style="background-color: #fff0f0">"MultiDataTile"</span>,
        error_code<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">None</span>,
        error_message<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">None</span>,
        target<span style="color: #333333">=</span><span style="color: #007020">str</span>(basedir),
        stacktrace<span style="color: #333333">=</span><span style="color: #008800; font-weight: bold">None</span>,
    )
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><h2 id="copy_input_to_rawfile">copy_input_to_rawfile</h2>
<div class="doc doc-object doc-function">
<div class="doc doc-contents first">
<p>Copy the input raw files to the specified directory.</p>
<p>This function takes a list of raw file paths and copies each file to the given <code>raw_dir_path</code>.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code>raw_dir_path</code></td>
<td>
<code><span title="pathlib.Path">Path</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The directory path where the raw files will be copied to.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>raw_files</code></td>
<td>
<code>tuple[<span title="pathlib.Path">Path</span>, ...]</code>
</td>
<td>
<div class="doc-md-description">
<p>A tuple of file paths that need to be copied.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>None</code>
</td>
<td>
<div class="doc-md-description">
<p>None</p>
</div>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>src/rdetoolkit/modeproc.py</code></summary>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">414</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">415</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">416</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">417</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">418</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">419</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">420</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">421</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">422</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">423</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">424</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">425</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">426</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">427</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">copy_input_to_rawfile</span>(raw_dir_path: Path, raw_files: <span style="color: #007020">tuple</span>[Path, <span style="color: #333333">...</span>]) <span style="color: #333333">-&gt;</span> <span style="color: #008800; font-weight: bold">None</span>:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Copy the input raw files to the specified directory.</span>

<span style="color: #DD4422">    This function takes a list of raw file paths and copies each file to the given `raw_dir_path`.</span>

<span style="color: #DD4422">    Args:</span>
<span style="color: #DD4422">        raw_dir_path (Path): The directory path where the raw files will be copied to.</span>
<span style="color: #DD4422">        raw_files (tuple[Path, ...]): A tuple of file paths that need to be copied.</span>

<span style="color: #DD4422">    Returns:</span>
<span style="color: #DD4422">        None</span>
<span style="color: #DD4422">    """</span>
    <span style="color: #008800; font-weight: bold">for</span> f <span style="color: #000000; font-weight: bold">in</span> raw_files:
        shutil<span style="color: #333333">.</span>copy(f, os<span style="color: #333333">.</span>path<span style="color: #333333">.</span>join(raw_dir_path, f<span style="color: #333333">.</span>name))
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><h2 id="selected_input_checker">selected_input_checker</h2>
<div class="doc doc-object doc-function">
<div class="doc doc-contents first">
<p>Determine the appropriate input file checker based on the provided format flags and source paths.</p>
<p>The function scans the source paths to identify the type of input files present. Based on the file type
and format flags provided, it instantiates and returns the appropriate checker.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code>src_paths</code></td>
<td>
<code><span title="rdetoolkit.models.rde2types.RdeInputDirPaths">RdeInputDirPaths</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Paths for the source input files.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>unpacked_dir_path</code></td>
<td>
<code><span title="pathlib.Path">Path</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Directory path for unpacked files.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>mode</code></td>
<td>
<code>Optional[str]</code>
</td>
<td>
<div class="doc-md-description">
<p>Format flags indicating which checker mode is enabled.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Name</th> <th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code>IInputFileChecker</code></td> <td>
<code><span title="rdetoolkit.interfaces.filechecker.IInputFileChecker">IInputFileChecker</span></code>
</td>
<td>
<div class="doc-md-description">
<p>An instance of the appropriate input file checker based on the provided criteria.</p>
</div>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>src/rdetoolkit/modeproc.py</code></summary>
<div class="highlight" style="background: #ffffff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">430</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">431</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">432</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">433</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">434</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">435</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">436</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">437</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">438</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">439</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">440</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">441</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">442</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">443</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">444</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">445</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">446</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">447</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">448</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">449</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">450</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">451</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">452</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">453</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">454</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">455</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">456</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">selected_input_checker</span>(src_paths: RdeInputDirPaths, unpacked_dir_path: Path, mode: <span style="color: #007020">str</span> <span style="color: #333333">|</span> <span style="color: #008800; font-weight: bold">None</span>) <span style="color: #333333">-&gt;</span> IInputFileChecker:
<span style="color: #bbbbbb">    </span><span style="color: #DD4422">"""Determine the appropriate input file checker based on the provided format flags and source paths.</span>

<span style="color: #DD4422">    The function scans the source paths to identify the type of input files present. Based on the file type</span>
<span style="color: #DD4422">    and format flags provided, it instantiates and returns the appropriate checker.</span>

<span style="color: #DD4422">    Args:</span>
<span style="color: #DD4422">        src_paths (RdeInputDirPaths): Paths for the source input files.</span>
<span style="color: #DD4422">        unpacked_dir_path (Path): Directory path for unpacked files.</span>
<span style="color: #DD4422">        mode (Optional[str]): Format flags indicating which checker mode is enabled.</span>

<span style="color: #DD4422">    Returns:</span>
<span style="color: #DD4422">        IInputFileChecker: An instance of the appropriate input file checker based on the provided criteria.</span>

<span style="color: #DD4422">    Raises:</span>
<span style="color: #DD4422">        None, but callers should be aware that downstream exceptions can be raised by individual checker initializations.</span>
<span style="color: #DD4422">    """</span>
    input_files <span style="color: #333333">=</span> <span style="color: #007020">list</span>(src_paths<span style="color: #333333">.</span>inputdata<span style="color: #333333">.</span>glob(<span style="background-color: #fff0f0">"*"</span>))
    excel_invoice_files <span style="color: #333333">=</span> [f <span style="color: #008800; font-weight: bold">for</span> f <span style="color: #000000; font-weight: bold">in</span> input_files <span style="color: #008800; font-weight: bold">if</span> f<span style="color: #333333">.</span>suffix<span style="color: #333333">.</span>lower() <span style="color: #000000; font-weight: bold">in</span> [<span style="background-color: #fff0f0">".xls"</span>, <span style="background-color: #fff0f0">".xlsx"</span>] <span style="color: #000000; font-weight: bold">and</span> f<span style="color: #333333">.</span>stem<span style="color: #333333">.</span>endswith(<span style="background-color: #fff0f0">"_excel_invoice"</span>)]
    mode <span style="color: #333333">=</span> mode<span style="color: #333333">.</span>lower() <span style="color: #008800; font-weight: bold">if</span> mode <span style="color: #000000; font-weight: bold">is</span> <span style="color: #000000; font-weight: bold">not</span> <span style="color: #008800; font-weight: bold">None</span> <span style="color: #008800; font-weight: bold">else</span> <span style="background-color: #fff0f0">""</span>
    <span style="color: #008800; font-weight: bold">if</span> mode <span style="color: #333333">==</span> <span style="background-color: #fff0f0">"rdeformat"</span>:
        <span style="color: #008800; font-weight: bold">return</span> RDEFormatChecker(unpacked_dir_path)
    <span style="color: #008800; font-weight: bold">if</span> mode <span style="color: #333333">==</span> <span style="background-color: #fff0f0">"multidatatile"</span>:
        <span style="color: #008800; font-weight: bold">return</span> MultiFileChecker(unpacked_dir_path)
    <span style="color: #008800; font-weight: bold">if</span> excel_invoice_files:
        <span style="color: #008800; font-weight: bold">return</span> ExcelInvoiceChecker(unpacked_dir_path)
    <span style="color: #008800; font-weight: bold">return</span> InvoiceChecker(unpacked_dir_path)
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/nims-dpfc/rdetoolkit" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<div class="md-consent" data-md-component="consent" hidden="" id="__consent">
<div class="md-consent__overlay"></div>
<aside class="md-consent__inner">
<form class="md-consent__form md-grid md-typeset" name="consent">
<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" id="__settings" type="checkbox"/>
<div class="md-consent__settings">
<ul class="task-list">
<li class="task-list-item">
<label class="task-list-control">
<input checked="" name="github" type="checkbox"/>
<span class="task-list-indicator"></span>
          GitHub
        </label>
</li>
</ul>
</div>
<div class="md-consent__controls">
<button class="md-button md-button--primary">Accept</button>
<label class="md-button" for="__settings">Manage settings</label>
</div>
</form>
</aside>
</div>
<script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.top", "toc.integrate", "navigation.tabs", "navigation.tabs.sticky"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.d6f25eb3.min.js"></script>
<script src="https://unpkg.com/mermaid@10.9.0/dist/mermaid.min.js"></script>
</body>
</html>